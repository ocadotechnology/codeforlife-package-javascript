{"version":3,"file":"session-eOp0H-EC.cjs","sources":["../src/api/endpoints/session.ts"],"sourcesContent":["import { type Api, type EndpointBuilder } from \"@reduxjs/toolkit/query/react\"\n\nimport { login, logout } from \"../../slices/session\"\n\nexport type ExchangeOAuth2CodeArg = {\n  code: string\n  code_verifier: string\n  redirect_uri: string\n}\n\nexport function buildLoginEndpoint<ResultType, QueryArg>(\n  build: EndpointBuilder<any, any, any>,\n  url: string = \"session/login/\",\n) {\n  return build.mutation<ResultType, QueryArg>({\n    query: body => ({ url, method: \"POST\", body }),\n    async onQueryStarted(_, { dispatch, queryFulfilled }) {\n      try {\n        await queryFulfilled\n        dispatch(login())\n      } catch (error) {\n        console.error(\"Failed to call login endpoint...\", error)\n      }\n    },\n  })\n}\n\nexport function buildLogoutEndpoint<ResultType, QueryArg>(\n  api: Api<any, any, any, any, any>,\n  build: EndpointBuilder<any, any, any>,\n  url: string = \"session/logout/\",\n) {\n  return build.mutation<ResultType, QueryArg>({\n    query: () => ({ url, method: \"POST\" }),\n    async onQueryStarted(_, { dispatch, queryFulfilled }) {\n      try {\n        await queryFulfilled\n      } catch (error) {\n        console.error(\"Failed to call logout endpoint...\", error)\n      } finally {\n        dispatch(logout())\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-call,@typescript-eslint/no-unsafe-member-access\n        dispatch(api.util.resetApiState())\n      }\n    },\n  })\n}\n"],"names":["buildLoginEndpoint","build","url","body","_","dispatch","queryFulfilled","login","error","buildLogoutEndpoint","api","logout"],"mappings":"+FAUO,SAASA,EACdC,EACAC,EAAc,iBACd,CACA,OAAOD,EAAM,SAA+B,CAC1C,MAAOE,IAAS,CAAE,IAAAD,EAAK,OAAQ,OAAQ,KAAAC,IACvC,MAAM,eAAeC,EAAG,CAAE,SAAAC,EAAU,eAAAC,GAAkB,CACpD,GAAI,CACF,MAAMA,EACND,EAASE,EAAAA,OAAO,CAClB,OAASC,EAAO,CACd,QAAQ,MAAM,mCAAoCA,CAAK,CACzD,CACF,CAAA,CACD,CACH,CAEO,SAASC,EACdC,EACAT,EACAC,EAAc,kBACd,CACA,OAAOD,EAAM,SAA+B,CAC1C,MAAO,KAAO,CAAE,IAAAC,EAAK,OAAQ,MAAA,GAC7B,MAAM,eAAeE,EAAG,CAAE,SAAAC,EAAU,eAAAC,GAAkB,CACpD,GAAI,CACF,MAAMA,CACR,OAASE,EAAO,CACd,QAAQ,MAAM,oCAAqCA,CAAK,CAC1D,QAAA,CACEH,EAASM,EAAAA,QAAQ,EAEjBN,EAASK,EAAI,KAAK,eAAe,CACnC,CACF,CAAA,CACD,CACH"}