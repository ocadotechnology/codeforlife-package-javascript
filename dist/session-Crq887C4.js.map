{"version":3,"file":"session-Crq887C4.js","sources":["../src/api/endpoints/session.ts"],"sourcesContent":["import { type Api, type EndpointBuilder } from \"@reduxjs/toolkit/query/react\"\n\nimport { login, logout } from \"../../slices/session\"\n\nexport type ExchangeOAuth2CodeArg = {\n  code: string\n  code_verifier: string\n  redirect_uri: string\n}\n\nexport function buildLoginEndpoint<ResultType, QueryArg>(\n  build: EndpointBuilder<any, any, any>,\n  url: string = \"session/login/\",\n) {\n  return build.mutation<ResultType, QueryArg>({\n    query: body => ({ url, method: \"POST\", body }),\n    async onQueryStarted(_, { dispatch, queryFulfilled }) {\n      try {\n        await queryFulfilled\n        dispatch(login())\n      } catch (error) {\n        console.error(\"Failed to call login endpoint...\", error)\n      }\n    },\n  })\n}\n\nexport function buildLogoutEndpoint<ResultType, QueryArg>(\n  api: Api<any, any, any, any, any>,\n  build: EndpointBuilder<any, any, any>,\n  url: string = \"session/logout/\",\n) {\n  return build.mutation<ResultType, QueryArg>({\n    query: () => ({ url, method: \"POST\" }),\n    async onQueryStarted(_, { dispatch, queryFulfilled }) {\n      try {\n        await queryFulfilled\n      } catch (error) {\n        console.error(\"Failed to call logout endpoint...\", error)\n      } finally {\n        dispatch(logout())\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-call,@typescript-eslint/no-unsafe-member-access\n        dispatch(api.util.resetApiState())\n      }\n    },\n  })\n}\n"],"names":["buildLoginEndpoint","build","url","body","_","dispatch","queryFulfilled","login","error","buildLogoutEndpoint","api","logout"],"mappings":";;AAUO,SAASA,EACdC,GACAC,IAAc,kBACd;AACA,SAAOD,EAAM,SAA+B;AAAA,IAC1C,OAAO,CAAAE,OAAS,EAAE,KAAAD,GAAK,QAAQ,QAAQ,MAAAC;IACvC,MAAM,eAAeC,GAAG,EAAE,UAAAC,GAAU,gBAAAC,KAAkB;AACpD,UAAI;AACF,cAAMA,GACND,EAASE,GAAO;AAAA,MAClB,SAASC,GAAO;AACd,gBAAQ,MAAM,oCAAoCA,CAAK;AAAA,MACzD;AAAA,IACF;AAAA,EAAA,CACD;AACH;AAEO,SAASC,EACdC,GACAT,GACAC,IAAc,mBACd;AACA,SAAOD,EAAM,SAA+B;AAAA,IAC1C,OAAO,OAAO,EAAE,KAAAC,GAAK,QAAQ,OAAA;AAAA,IAC7B,MAAM,eAAeE,GAAG,EAAE,UAAAC,GAAU,gBAAAC,KAAkB;AACpD,UAAI;AACF,cAAMA;AAAA,MACR,SAASE,GAAO;AACd,gBAAQ,MAAM,qCAAqCA,CAAK;AAAA,MAC1D,UAAA;AACE,QAAAH,EAASM,GAAQ,GAEjBN,EAASK,EAAI,KAAK,eAAe;AAAA,MACnC;AAAA,IACF;AAAA,EAAA,CACD;AACH;"}