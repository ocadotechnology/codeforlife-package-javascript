{"version":3,"file":"Countdown-CZ3lVNH0.js","sources":["../src/hooks/general.tsx","../src/components/Countdown.tsx"],"sourcesContent":["import {\n  type DependencyList,\n  type Dispatch,\n  type SetStateAction,\n  useEffect,\n  useState,\n} from \"react\"\n\nexport function useExternalScript<EventType extends keyof HTMLElementEventMap>({\n  props,\n  attrs,\n  eventTypes,\n}: {\n  props: Partial<HTMLScriptElement> & { src: string }\n  attrs?: Record<string, string>\n  eventTypes?: EventType[]\n}): EventType | undefined {\n  const [eventType, setEventType] = useState<EventType>()\n\n  useEffect(() => {\n    if (\n      document.querySelector<HTMLScriptElement>(`script[src=\"${props.src}\"]`)\n    ) {\n      throw Error(\"already exists\")\n    }\n\n    const script = document.createElement(\"script\")\n\n    Object.entries(props).forEach(([key, value]) => {\n      // @ts-expect-error value is assignable\n      script[key] = value\n    })\n\n    if (attrs !== undefined) {\n      Object.entries(attrs).forEach(([key, value]) => {\n        script.setAttribute(key, value)\n      })\n    }\n\n    function eventListener(event: Event): void {\n      setEventType(event.type as EventType)\n    }\n\n    eventTypes?.forEach(eventType => {\n      script.addEventListener(eventType, eventListener)\n    })\n\n    document.head.appendChild(script)\n\n    return () => {\n      eventTypes?.forEach(eventType => {\n        script.removeEventListener(eventType, eventListener)\n      })\n\n      document.head.removeChild(script)\n    }\n  }, [eventTypes, attrs, props])\n\n  return eventType\n}\n\nexport function useCountdown(\n  seconds: number,\n  interval: number = 1,\n): [number, Dispatch<SetStateAction<number>>] {\n  if (seconds <= 0) throw Error(\"seconds must be > 0\")\n  if (interval <= 0) throw Error(\"interval must be > 0\")\n\n  const [_seconds, _setSeconds] = useState(seconds)\n\n  useEffect(() => {\n    const countdown = setInterval(() => {\n      _setSeconds(seconds => {\n        seconds = seconds - interval\n        return seconds < 0 ? 0 : seconds\n      })\n    }, interval * 1000)\n\n    return () => {\n      clearInterval(countdown)\n    }\n  }, [interval])\n\n  return [_seconds, _setSeconds]\n}\n\nexport function useEventListener<EventType extends keyof HTMLElementEventMap>(\n  element: HTMLElement,\n  type: EventType,\n  listener: (this: HTMLElement, ev: HTMLElementEventMap[EventType]) => any,\n  kwArgs: {\n    options?: boolean | AddEventListenerOptions\n    deps?: DependencyList\n  } = {},\n): void {\n  const { options, deps = [] } = kwArgs\n\n  useEffect(\n    () => {\n      element.addEventListener(type, listener, options)\n\n      return () => {\n        element.removeEventListener(type, listener, options)\n      }\n    },\n    // TODO: simplify this hook.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    deps,\n  )\n}\n","import { type FC, useState } from \"react\"\nimport { Typography, type TypographyProps } from \"@mui/material\"\n\nimport { useCountdown } from \"../hooks\"\n\nexport interface CountdownProps extends Omit<TypographyProps, \"children\"> {\n  seconds: number\n  start?: boolean\n  onEnd: () => void\n}\n\nconst Countdown: FC<CountdownProps> = ({\n  seconds,\n  start = true,\n  onEnd,\n  ...typographyProps\n}) => {\n  seconds = Math.floor(seconds)\n  const _seconds = useCountdown(seconds)[0]\n  const [end, setEnd] = useState(!start)\n\n  if (_seconds === 0 && !end) {\n    setEnd(true)\n    onEnd()\n  }\n\n  seconds = Math.floor(_seconds % 60)\n  const minutes = Math.floor(_seconds / 60)\n\n  return (\n    <>\n      {_seconds > 0 && (\n        <Typography {...typographyProps}>\n          {minutes > 0 && `${minutes} ${minutes > 1 ? \"mins\" : \"min\"} `}\n          {seconds > 0 && `${seconds} ${seconds > 1 ? \"secs\" : \"sec\"}`}\n        </Typography>\n      )}\n    </>\n  )\n}\n\nexport default Countdown\n"],"names":["useExternalScript","props","attrs","eventTypes","eventType","setEventType","useState","useEffect","script","key","value","eventListener","event","useCountdown","seconds","interval","_seconds","_setSeconds","countdown","useEventListener","element","type","listener","kwArgs","options","deps","Countdown","start","onEnd","typographyProps","end","setEnd","minutes","jsxs","Typography"],"mappings":"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"}