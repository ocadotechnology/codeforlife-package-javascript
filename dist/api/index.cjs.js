"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const v=require("../rtk-query.modern-C0Q3pEC1.cjs"),x=require("@reduxjs/toolkit"),T=require("react-redux"),n=require("react"),re=require("../settings/index.cjs.js"),ie=require("../session-CacrgFSv.cjs"),W=require("../utils/auth.cjs.js"),ue=require("../api-CnMfjRk3.cjs"),ce=require("../schemas-BZbJpkD5.cjs"),ae=require("../urls-MaVXL_C2.cjs");function $(t){return t.replace(t[0],t[0].toUpperCase())}function fe(t){let l=0;for(const S in t)l++;return l}function de(t){return t.type==="query"}function le(t){return t.type==="mutation"}function te(t){return t.type==="infinitequery"}function z(t,...l){return Object.assign(t,...l)}var Y=Symbol();function Z(t,l,S,h){const k=n.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?l({queryArgs:t,endpointDefinition:S,endpointName:h}):t}),[t,l,S,h]),b=n.useRef(k);return n.useEffect(()=>{b.current.serialized!==k.serialized&&(b.current=k)},[k]),b.current.serialized===k.serialized?b.current.queryArgs:t}function j(t){const l=n.useRef(t);return n.useEffect(()=>{T.shallowEqual(l.current,t)||(l.current=t)},[t]),T.shallowEqual(l.current,t)?l.current:t}var pe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",be=pe(),ye=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ge=ye(),he=()=>be||ge?n.useLayoutEffect:n.useEffect,ke=he(),ee=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:v.QueryStatus.pending}:t;function J(t,...l){const S={};return l.forEach(h=>{S[h]=t[h]}),S}var X=["data","status","isLoading","isSuccess","isError","error"];function Se({api:t,moduleOptions:{batch:l,hooks:{useDispatch:S,useSelector:h,useStore:k},unstable__sideEffectsInRender:b,createSelector:E},serializeQueryArgs:m,context:Q}){const C=b?e=>e():n.useEffect;return{buildQueryHooks:A,buildInfiniteQueryHooks:K,buildMutationHook:B,usePrefetch:G};function N(e,r,d){if(r?.endpointName&&e.isUninitialized){const{endpointName:u}=r,a=Q.endpointDefinitions[u];d!==v.skipToken&&m({queryArgs:r.originalArgs,endpointDefinition:a,endpointName:u})===m({queryArgs:d,endpointDefinition:a,endpointName:u})&&(r=void 0)}let c=e.isSuccess?e.data:r?.data;c===void 0&&(c=e.data);const i=c!==void 0,s=e.isLoading,o=(!r||r.isLoading||r.isUninitialized)&&!i&&s,f=e.isSuccess||i&&(s&&!r?.isError||e.isUninitialized);return{...e,data:c,currentData:e.data,isFetching:s,isLoading:o,isSuccess:f}}function F(e,r,d){if(r?.endpointName&&e.isUninitialized){const{endpointName:u}=r,a=Q.endpointDefinitions[u];d!==v.skipToken&&m({queryArgs:r.originalArgs,endpointDefinition:a,endpointName:u})===m({queryArgs:d,endpointDefinition:a,endpointName:u})&&(r=void 0)}let c=e.isSuccess?e.data:r?.data;c===void 0&&(c=e.data);const i=c!==void 0,s=e.isLoading,o=(!r||r.isLoading||r.isUninitialized)&&!i&&s,f=e.isSuccess||s&&i;return{...e,data:c,currentData:e.data,isFetching:s,isLoading:o,isSuccess:f}}function G(e,r){const d=S(),c=j(r);return n.useCallback((i,s)=>d(t.util.prefetch(e,i,{...c,...s})),[e,d,c])}function D(e,r,{refetchOnReconnect:d,refetchOnFocus:c,refetchOnMountOrArgChange:i,skip:s=!1,pollingInterval:o=0,skipPollingIfUnfocused:f=!1,...u}={}){const{initiate:a}=t.endpoints[e],y=S(),q=n.useRef(void 0);if(!q.current){const L=y(t.internalActions.internal_getRTKQSubscriptions());if(process.env.NODE_ENV!=="production"&&(typeof L!="object"||typeof L?.type=="string"))throw new Error(process.env.NODE_ENV==="production"?x.formatProdErrorMessage(37):`Warning: Middleware for RTK-Query API at reducerPath "${t.reducerPath}" has not been added to the store.
    You must add the middleware for RTK-Query to function correctly!`);q.current=L}const p=Z(s?v.skipToken:r,v.defaultSerializeQueryArgs,Q.endpointDefinitions[e],e),g=j({refetchOnReconnect:d,refetchOnFocus:c,pollingInterval:o,skipPollingIfUnfocused:f}),P=u.initialPageParam,M=j(P),O=n.useRef(void 0);let{queryCacheKey:I,requestId:U}=O.current||{},V=!1;I&&U&&(V=q.current.isRequestSubscribed(I,U));const H=!V&&O.current!==void 0;return C(()=>{H&&(O.current=void 0)},[H]),C(()=>{const L=O.current;if(typeof process<"u"&&process.env.NODE_ENV==="removeMeOnCompilation"&&console.log(H),p===v.skipToken){L?.unsubscribe(),O.current=void 0;return}const se=O.current?.subscriptionOptions;if(!L||L.arg!==p){L?.unsubscribe();const oe=y(a(p,{subscriptionOptions:g,forceRefetch:i,...te(Q.endpointDefinitions[e])?{initialPageParam:M}:{}}));O.current=oe}else g!==se&&L.updateSubscriptionOptions(g)},[y,a,i,p,g,H,M,e]),[O,y,a,g]}function _(e,r){return(c,{skip:i=!1,selectFromResult:s}={})=>{const{select:o}=t.endpoints[e],f=Z(i?v.skipToken:c,m,Q.endpointDefinitions[e],e),u=n.useRef(void 0),a=n.useMemo(()=>E([o(f),(P,M)=>M,P=>f],r,{memoizeOptions:{resultEqualityCheck:T.shallowEqual}}),[o,f]),y=n.useMemo(()=>s?E([a],s,{devModeChecks:{identityFunctionCheck:"never"}}):a,[a,s]),q=h(P=>y(P,u.current),T.shallowEqual),p=k(),g=a(p.getState(),u.current);return ke(()=>{u.current=g},[g]),q}}function w(e){n.useEffect(()=>()=>{e.current?.unsubscribe?.(),e.current=void 0},[e])}function R(e){if(!e.current)throw new Error(process.env.NODE_ENV==="production"?x.formatProdErrorMessage(38):"Cannot refetch a query that has not been started yet.");return e.current.refetch()}function A(e){const r=(i,s={})=>{const[o]=D(e,i,s);return w(o),n.useMemo(()=>({refetch:()=>R(o)}),[o])},d=({refetchOnReconnect:i,refetchOnFocus:s,pollingInterval:o=0,skipPollingIfUnfocused:f=!1}={})=>{const{initiate:u}=t.endpoints[e],a=S(),[y,q]=n.useState(Y),p=n.useRef(void 0),g=j({refetchOnReconnect:i,refetchOnFocus:s,pollingInterval:o,skipPollingIfUnfocused:f});C(()=>{const I=p.current?.subscriptionOptions;g!==I&&p.current?.updateSubscriptionOptions(g)},[g]);const P=n.useRef(g);C(()=>{P.current=g},[g]);const M=n.useCallback(function(I,U=!1){let V;return l(()=>{p.current?.unsubscribe(),p.current=V=a(u(I,{subscriptionOptions:P.current,forceRefetch:!U})),q(I)}),V},[a,u]),O=n.useCallback(()=>{p.current?.queryCacheKey&&a(t.internalActions.removeQueryResult({queryCacheKey:p.current?.queryCacheKey}))},[a]);return n.useEffect(()=>()=>{p?.current?.unsubscribe()},[]),n.useEffect(()=>{y!==Y&&!p.current&&M(y,!0)},[y,M]),n.useMemo(()=>[M,y,{reset:O}],[M,y,O])},c=_(e,N);return{useQueryState:c,useQuerySubscription:r,useLazyQuerySubscription:d,useLazyQuery(i){const[s,o,{reset:f}]=d(i),u=c(o,{...i,skip:o===Y}),a=n.useMemo(()=>({lastArg:o}),[o]);return n.useMemo(()=>[s,{...u,reset:f},a],[s,u,f,a])},useQuery(i,s){const o=r(i,s),f=c(i,{selectFromResult:i===v.skipToken||s?.skip?void 0:ee,...s}),u=J(f,...X);return n.useDebugValue(u),n.useMemo(()=>({...f,...o}),[f,o])}}}function K(e){const r=(c,i={})=>{const[s,o,f,u]=D(e,c,i),a=n.useRef(u);C(()=>{a.current=u},[u]);const y=n.useCallback(function(g,P){let M;return l(()=>{s.current?.unsubscribe(),s.current=M=o(f(g,{subscriptionOptions:a.current,direction:P}))}),M},[s,o,f]);w(s);const q=Z(i.skip?v.skipToken:c,v.defaultSerializeQueryArgs,Q.endpointDefinitions[e],e),p=n.useCallback(()=>R(s),[s]);return n.useMemo(()=>({trigger:y,refetch:p,fetchNextPage:()=>y(q,"forward"),fetchPreviousPage:()=>y(q,"backward")}),[p,y,q])},d=_(e,F);return{useInfiniteQueryState:d,useInfiniteQuerySubscription:r,useInfiniteQuery(c,i){const{refetch:s,fetchNextPage:o,fetchPreviousPage:f}=r(c,i),u=d(c,{selectFromResult:c===v.skipToken||i?.skip?void 0:ee,...i}),a=J(u,...X,"hasNextPage","hasPreviousPage");return n.useDebugValue(a),n.useMemo(()=>({...u,fetchNextPage:o,fetchPreviousPage:f,refetch:s}),[u,o,f,s])}}}function B(e){return({selectFromResult:r,fixedCacheKey:d}={})=>{const{select:c,initiate:i}=t.endpoints[e],s=S(),[o,f]=n.useState();n.useEffect(()=>()=>{o?.arg.fixedCacheKey||o?.reset()},[o]);const u=n.useCallback(function(I){const U=s(i(I,{fixedCacheKey:d}));return f(U),U},[s,i,d]),{requestId:a}=o||{},y=n.useMemo(()=>c({fixedCacheKey:d,requestId:o?.requestId}),[d,o,c]),q=n.useMemo(()=>r?E([y],r):y,[r,y]),p=h(q,T.shallowEqual),g=d==null?o?.arg.originalArgs:void 0,P=n.useCallback(()=>{l(()=>{o&&f(void 0),d&&s(t.internalActions.removeMutationResult({requestId:a,fixedCacheKey:d}))})},[s,d,o,a]),M=J(p,...X,"endpointName");n.useDebugValue(M);const O=n.useMemo(()=>({...p,originalArgs:g,reset:P}),[p,g,P]);return n.useMemo(()=>[u,O],[u,O])}}}var me=Symbol(),ve=({batch:t=T.batch,hooks:l={useDispatch:T.useDispatch,useSelector:T.useSelector,useStore:T.useStore},createSelector:S=v.createSelector,unstable__sideEffectsInRender:h=!1,...k}={})=>{if(process.env.NODE_ENV!=="production"){const b=["useDispatch","useSelector","useStore"];let E=!1;for(const m of b)if(fe(k)>0&&(k[m]&&(E||(console.warn("As of RTK 2.0, the hooks now need to be specified as one object, provided under a `hooks` key:\n`reactHooksModule({ hooks: { useDispatch, useSelector, useStore } })`"),E=!0)),l[m]=k[m]),typeof l[m]!="function")throw new Error(process.env.NODE_ENV==="production"?x.formatProdErrorMessage(36):`When using custom hooks for context, all ${b.length} hooks need to be provided: ${b.join(", ")}.
Hook ${m} was either not provided or not a function.`)}return{name:me,init(b,{serializeQueryArgs:E},m){const Q=b,{buildQueryHooks:C,buildInfiniteQueryHooks:N,buildMutationHook:F,usePrefetch:G}=Se({api:b,moduleOptions:{batch:t,hooks:l,unstable__sideEffectsInRender:h,createSelector:S},serializeQueryArgs:E,context:m});return z(Q,{usePrefetch:G}),z(m,{batch:t}),{injectEndpoint(D,_){if(de(_)){const{useQuery:w,useLazyQuery:R,useLazyQuerySubscription:A,useQueryState:K,useQuerySubscription:B}=C(D);z(Q.endpoints[D],{useQuery:w,useLazyQuery:R,useLazyQuerySubscription:A,useQueryState:K,useQuerySubscription:B}),b[`use${$(D)}Query`]=w,b[`useLazy${$(D)}Query`]=R}if(le(_)){const w=F(D);z(Q.endpoints[D],{useMutation:w}),b[`use${$(D)}Mutation`]=w}else if(te(_)){const{useInfiniteQuery:w,useInfiniteQuerySubscription:R,useInfiniteQueryState:A}=N(D);z(Q.endpoints[D],{useInfiniteQuery:w,useInfiniteQuerySubscription:R,useInfiniteQueryState:A}),b[`use${$(D)}InfiniteQuery`]=w}}}}}},Ee=v.buildCreateApi(v.coreModule(),ve());const ne=["User","School","Class","AuthFactor"];function Qe({tagTypes:t=[]}={}){const l=v.fetchBaseQuery({baseUrl:`${re.SERVICE_API_URL}/`,credentials:"include",prepareHeaders:(h,k)=>{const{type:b,arg:E}=k,m=typeof E=="string"?"GET":E.method||"GET";if(b==="mutation"||!ue.isSafeHttpMethod(m)){const Q=W.getCsrfCookie();Q&&h.set("x-csrftoken",Q)}return h}}),S=Ee({baseQuery:async(h,k,b)=>{if(k.type==="mutation"&&W.getCsrfCookie()===void 0){const{error:E}=await l({url:"/csrf/cookie/",method:"GET"},k,{});E!==void 0&&console.error(E),W.getCsrfCookie()}return await l(h,k,b)},tagTypes:[...ne,...t],endpoints:()=>({})});return S.injectEndpoints({endpoints:h=>({logout:ie.buildLogoutEndpoint(S,h)})})}exports.schemas=ce.schemas;exports.urls=ae.urls;exports.createApi=Qe;exports.tagTypes=ne;
//# sourceMappingURL=index.cjs.js.map
