"use strict";const e=require("react/jsx-runtime"),m=require("@mui/material"),T=require("react"),Z=require("./api-G8CV5bUa.cjs"),ee=require("./api-DIgp_6Vr.cjs"),_=require("formik"),O=require("yup"),q=require("./utils/form.cjs.js"),g=require("./utils/general.cjs.js");require("dayjs/locale/en-gb");const w=require("@mui/x-date-pickers"),te=require("dayjs"),re=require("@mui/x-date-pickers/AdapterDayjs"),I=require("@mui/icons-material");require("@reduxjs/toolkit/query/react");require("./settings/index.cjs.js");require("./session-CE2U7oL1.cjs");require("js-cookie");const oe=require("./schemas-hIW9-H6-.cjs");require("./urls-2gheISSO.cjs");const R=({useLazyListQuery:r,filterOptions:t,getOptionLabel:n,getOptionKey:o=l=>l.id,searchKey:s,...i})=>{const[l,d]=T.useState(""),[a,{isLoading:c,isError:u}]=r(),[{limit:f,offset:p},x]=ee.usePagination(),[{options:b,hasMore:F},S]=T.useState({options:{},hasMore:!0});T.useEffect(()=>{const j={limit:f,offset:p,...t};l&&(j[s]=l),a(j,!0).unwrap().then(({data:C,offset:v,limit:N,count:V})=>{S(({options:X})=>{const k={...X};return C.forEach(L=>{k[o(L)]=L}),{options:k,hasMore:v+N<V}})}).catch(C=>{C&&console.error(C)})},[a,f,p,s,l,...Object.values(t||{})]);let h=Object.keys(b);if(!h.length)return e.jsx(e.Fragment,{});typeof o(Object.values(b)[0])=="number"&&(h=h.map(Number));function y(){x(({page:j,limit:C})=>({page:j+1,limit:C}))}const P=({children:j,...C},v)=>{const N=T.Children.toArray(j);return c?N.push(e.jsx(m.CircularProgress,{},"is-loading")):(u&&N.push(e.jsx(Z.SyncError,{},"is-error")),F&&N.push(e.jsx(m.Button,{onClick:y,children:"Load more"},"load-more"))),e.jsx("ul",{...C,ref:v,onScroll:V=>{!c&&V.currentTarget.clientHeight+V.currentTarget.scrollTop>=V.currentTarget.scrollHeight&&y()},children:N})};return e.jsx(B,{options:h,getOptionLabel:j=>n(b[j]),onInputChange:(j,C,v)=>{d(v==="input"?C:"")},ListboxComponent:T.forwardRef(P),...i})},B=({textFieldProps:r,options:t,validateOptions:n,...o})=>{const{id:s,name:i,required:l,...d}=r,a=i.split("."),c="not a valid option";let u=typeof t[0]=="string"?O.string().oneOf(t,c):O.number().oneOf(t,c);l&&(u=u.required());const f={name:i,type:typeof t[0]=="string"?"text":"number",validate:q.schemaToFieldValidator(u,n)};return e.jsx(_.Field,{...f,children:({form:p,meta:x})=>{const b=g.getNestedProperty(p.values,a),F=g.getNestedProperty(p.touched,a),S=g.getNestedProperty(p.errors,a);return e.jsx(m.Autocomplete,{options:t,defaultValue:x.initialValue===""?void 0:x.initialValue,renderInput:({id:h,...y})=>e.jsx(m.TextField,{id:s??i,name:i,required:l,type:"text",value:b,error:F&&!!S,helperText:F&&S,...d,...y}),onChange:(h,y)=>{p.setFieldValue(i,y??void 0,!0)},onBlur:p.handleBlur,...o})}})},M=({id:r,name:t,formControlLabelProps:n,required:o=!1,errorMessage:s="this is a required field",validateOptions:i,...l})=>{const d=t.split(".");let a=O.bool();o&&(a=a.oneOf([!0],s));const c={name:t,type:"checkbox",validate:q.schemaToFieldValidator(a,i)};return e.jsx(_.Field,{...c,children:({form:u,meta:f})=>{const p=g.getNestedProperty(u.touched,d),x=g.getNestedProperty(u.errors,d),b=g.getNestedProperty(u.values,d),F=p&&!!x;return e.jsxs(m.FormControl,{error:F,required:o,children:[e.jsx(m.FormControlLabel,{control:e.jsx(m.Checkbox,{defaultChecked:f.initialValue,id:r??t,name:t,value:b,onChange:u.handleChange,onBlur:u.handleBlur,...l}),...n}),F&&e.jsx(m.FormHelperText,{children:x})]})}})},U=({textFieldProps:r,...t})=>{const{name:n="country",label:o="Country",placeholder:s="Select your country",...i}=r||{};return e.jsx(B,{options:g.COUNTRY_ISO_CODES,getOptionLabel:l=>g.COUNTRY_ISO_CODE_MAPPING[l],textFieldProps:{name:n,label:o,placeholder:s,...i},...t})},Y=({name:r,required:t,minDate:n,maxDate:o,validateOptions:s,...i})=>{const l=r.split(".");function d(u){return u.locale("en-gb").format("L")}let a=O.date();t&&(a=a.required()),n&&(a=a.min(n,`this field must be after or equal to ${d(n)}`)),o&&(a=a.max(o,`this field must be before or equal to ${d(o)}`));const c={name:r,type:"date",validate:q.schemaToFieldValidator(a,s)};return e.jsx(_.Field,{...c,children:({form:u})=>{const f=g.getNestedProperty(u.errors,l),p=g.getNestedProperty(u.touched,l);let x=g.getNestedProperty(u.values,l);x=x?te(x):null;function b(F){u.setFieldValue(r,F&&F.isValid()?F.format("YYYY-MM-DD"):null,!0)}return e.jsx(w.LocalizationProvider,{dateAdapter:re.AdapterDayjs,adapterLocale:"en-gb",children:e.jsx(w.DatePicker,{name:r,value:x,minDate:n,maxDate:o,onChange:b,slotProps:{textField:{id:r,onChange:F=>{b(F)},onBlur:u.handleBlur,required:t,error:p&&!!f,helperText:p&&f}},...i})})}})},E=({id:r,name:t,schema:n,type:o="text",required:s=!1,dirty:i=!1,unique:l=!1,uniqueCaseInsensitive:d=!1,split:a,validateOptions:c,...u})=>{const[f,p]=T.useState(""),x=t.split(".");function b(){let h=n;if(h=s?h.required():h.optional(),i&&!a&&(h=h.notOneOf([f],"cannot be initial value")),!a)return h;let y=O.array().of(h);return y=s?y.required().min(1):y.optional(),(l||d)&&(y=y.test({message:"cannot have duplicates",test:P=>Array.isArray(P)&&P.length>=2&&P.every(j=>typeof j=="string")?new Set(d?P.map(j=>j.toLowerCase()):P).size===P.length:!0})),i&&(y=y.notOneOf([f],"cannot be initial value")),y}const F={name:t,type:o,validate:q.schemaToFieldValidator(b(),c)},S=({form:h})=>{const y=g.getNestedProperty(h.initialValues,x),P=g.getNestedProperty(h.values,x),j=g.getNestedProperty(h.errors,x),C=g.getNestedProperty(h.touched,x);return T.useEffect(()=>{p(y)},[y]),T.useEffect(()=>{h.setFieldValue(t,a&&typeof P=="string"?P.split(a):P,!0)},[P]),e.jsx(m.TextField,{id:r??t,name:t,type:o,required:s,value:P,onChange:h.handleChange,onBlur:h.handleBlur,error:C&&!!j,helperText:C&&j,...u})};return e.jsx(_.Field,{...F,children:S})},D=({name:r="email",label:t="Email address",placeholder:n="Enter your email address",InputProps:o={},...s})=>e.jsx(E,{type:"email",schema:O.string().email(),name:r,label:t,placeholder:n,InputProps:{endAdornment:e.jsx(m.InputAdornment,{position:"end",children:e.jsx(I.EmailOutlined,{})}),...o},...s}),H=({name:r="first_name",label:t="First name",placeholder:n="Enter your first name",InputProps:o={},...s})=>e.jsx(E,{schema:oe.user.first_name,name:r,label:t,placeholder:n,InputProps:{endAdornment:e.jsx(m.InputAdornment,{position:"end",children:e.jsx(I.PersonOutlined,{})}),...o},...s}),z={behavior:"smooth",block:"start"},ne=({scrollIntoViewOptions:r=z,...t})=>{const n=T.useRef(null);return T.useEffect(()=>{n.current&&n.current.scrollIntoView(r)},[r]),e.jsx(m.FormHelperText,{ref:n,error:!0,...t})},K=({children:r,scrollIntoViewOptions:t=z,nonFieldErrorsProps:n,fieldRefs:o=[],...s})=>e.jsx(_.Formik,{...s,children:i=>{const l=!!Object.keys(i.errors).length,d=l&&typeof i.errors.__all__=="string";if(l&&!d&&i.isSubmitting&&o.length){const a=g.getKeyPaths(i.errors),c=o.find(({name:u})=>a.includes(u))?.inputRef.current;c&&c.scrollIntoView(t)}return e.jsxs(e.Fragment,{children:[d&&e.jsx(ne,{...n,children:i.errors.__all__}),e.jsx(_.Form,{children:typeof r=="function"?r(i):r})]})}}),se=({useMutation:r,submitOptions:t,...n})=>{const[o]=r();return e.jsx(K,{...n,onSubmit:q.submitForm(o,n.initialValues,t)})},$=r=>"onSubmit"in r?e.jsx(K,{...r}):se(r),G=({name:r="otp",label:t="OTP",placeholder:n="Enter your OTP",...o})=>e.jsx(E,{name:r,label:t,schema:O.string().matches(/^[0-9]{6}$/,"Must be exactly 6 digits."),placeholder:n,required:!0,...o}),ie=({id:r,repeatName:t,setValue:n,fieldProps:o,name:s,label:i,placeholder:l,type:d,...a})=>{const{form:c}=o,u=s.split("."),f=g.getNestedProperty(c.values,u),p=t.split("."),x=g.getNestedProperty(c.values,p),b=g.getNestedProperty(c.touched,p),F=g.getNestedProperty(c.errors,p);return T.useEffect(()=>{n(f)},[n,f]),e.jsx(m.TextField,{required:!0,type:d,label:i??`Repeat ${s.replace("_"," ")}`,placeholder:l??`Enter your ${s.replace("_"," ")} again`,id:r??t,name:t,value:x,onChange:c.handleChange,onBlur:c.handleBlur,error:b&&!!F,helperText:b&&F,...a})},A=({name:r,type:t="text",validateOptions:n,...o})=>{const[s,i]=T.useState(""),l=`${r}_repeat`,d={name:l,type:t,validate:q.schemaToFieldValidator(O.string().required().equals([s],"does not match"),n)};return e.jsx(_.Field,{...d,children:a=>e.jsx(ie,{name:r,type:t,repeatName:l,setValue:i,fieldProps:a,...o})})},W=({name:r="password",label:t="Password",placeholder:n="Enter your password",schema:o=O.string(),InputProps:s={},withRepeatField:i=!1,repeatFieldProps:l={},...d})=>{const[a,c]=T.useState(!1),u=a?"text":"password",f=e.jsx(m.InputAdornment,{position:"end",children:e.jsx(m.IconButton,{onClick:()=>{c(p=>!p)},edge:"end",children:a?e.jsx(I.Visibility,{}):e.jsx(I.VisibilityOff,{})})});return e.jsxs(e.Fragment,{children:[e.jsx(E,{autoComplete:"off",type:u,name:r,label:t,schema:o,placeholder:n,InputProps:{endAdornment:f,...s},...d}),i&&e.jsx(A,{name:r,type:u,...l,InputProps:{endAdornment:f,...l.InputProps}})]})},J=({children:r="Submit",...t})=>{function n(o,s){s=s||{};for(const i in o){const l=o[i];s[i]=l instanceof Object&&l.constructor===Object?n(l,s):!0}return s}return e.jsx(_.Field,{name:"submit",type:"submit",children:({form:o})=>e.jsx(m.Button,{type:"button",onClick:()=>{o.setTouched(n(o.values),!0).then(s=>{const i=!!(s&&Object.keys(s).length);o.setSubmitting(i),i||o.submitForm()})},...t,children:r})})},Q=({textFieldProps:r,...t})=>{const{name:n="uk_county",label:o="UK county",placeholder:s="Select your UK county",...i}=r||{};return e.jsx(B,{options:g.UK_COUNTIES,textFieldProps:{name:n,label:o,placeholder:s,...i},...t})},le=Object.freeze(Object.defineProperty({__proto__:null,ApiAutocompleteField:R,AutocompleteField:B,CheckboxField:M,CountryField:U,DatePickerField:Y,EmailField:D,FirstNameField:H,Form:$,OtpField:G,PasswordField:W,RepeatField:A,SubmitButton:J,TextField:E,UkCountyField:Q},Symbol.toStringTag,{value:"Module"}));exports.ApiAutocompleteField=R;exports.AutocompleteField=B;exports.CheckboxField=M;exports.CountryField=U;exports.DatePickerField=Y;exports.EmailField=D;exports.FirstNameField=H;exports.Form=$;exports.OtpField=G;exports.PasswordField=W;exports.RepeatField=A;exports.SubmitButton=J;exports.TextField=E;exports.UkCountyField=Q;exports.index=le;
//# sourceMappingURL=index-Dadidnct.cjs.map
