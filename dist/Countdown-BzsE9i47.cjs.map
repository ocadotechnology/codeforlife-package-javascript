{"version":3,"file":"Countdown-BzsE9i47.cjs","sources":["../src/hooks/general.tsx","../src/components/Countdown.tsx"],"sourcesContent":["import {\n  type DependencyList,\n  type Dispatch,\n  type SetStateAction,\n  useEffect,\n  useState,\n} from \"react\"\n\nexport function useExternalScript<EventType extends keyof HTMLElementEventMap>({\n  props,\n  attrs,\n  eventTypes,\n}: {\n  props: Partial<HTMLScriptElement> & { src: string }\n  attrs?: Record<string, string>\n  eventTypes?: EventType[]\n}): EventType | undefined {\n  const [eventType, setEventType] = useState<EventType>()\n\n  useEffect(() => {\n    if (\n      document.querySelector<HTMLScriptElement>(`script[src=\"${props.src}\"]`)\n    ) {\n      throw Error(\"already exists\")\n    }\n\n    const script = document.createElement(\"script\")\n\n    Object.entries(props).forEach(([key, value]) => {\n      // @ts-expect-error value is assignable\n      script[key] = value\n    })\n\n    if (attrs !== undefined) {\n      Object.entries(attrs).forEach(([key, value]) => {\n        script.setAttribute(key, value)\n      })\n    }\n\n    function eventListener(event: Event): void {\n      setEventType(event.type as EventType)\n    }\n\n    eventTypes?.forEach(eventType => {\n      script.addEventListener(eventType, eventListener)\n    })\n\n    document.head.appendChild(script)\n\n    return () => {\n      eventTypes?.forEach(eventType => {\n        script.removeEventListener(eventType, eventListener)\n      })\n\n      document.head.removeChild(script)\n    }\n  }, [eventTypes, attrs, props])\n\n  return eventType\n}\n\nexport function useCountdown(\n  seconds: number,\n  interval: number = 1,\n): [number, Dispatch<SetStateAction<number>>] {\n  if (seconds <= 0) throw Error(\"seconds must be > 0\")\n  if (interval <= 0) throw Error(\"interval must be > 0\")\n\n  const [_seconds, _setSeconds] = useState(seconds)\n\n  useEffect(() => {\n    const countdown = setInterval(() => {\n      _setSeconds(seconds => {\n        seconds = seconds - interval\n        return seconds < 0 ? 0 : seconds\n      })\n    }, interval * 1000)\n\n    return () => {\n      clearInterval(countdown)\n    }\n  }, [interval])\n\n  return [_seconds, _setSeconds]\n}\n\nexport function useEventListener<EventType extends keyof HTMLElementEventMap>(\n  element: HTMLElement,\n  type: EventType,\n  listener: (this: HTMLElement, ev: HTMLElementEventMap[EventType]) => any,\n  kwArgs: {\n    options?: boolean | AddEventListenerOptions\n    deps?: DependencyList\n  } = {},\n): void {\n  const { options, deps = [] } = kwArgs\n\n  useEffect(\n    () => {\n      element.addEventListener(type, listener, options)\n\n      return () => {\n        element.removeEventListener(type, listener, options)\n      }\n    },\n    // TODO: simplify this hook.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    deps,\n  )\n}\n","import { type FC, useState } from \"react\"\nimport { Typography, type TypographyProps } from \"@mui/material\"\n\nimport { useCountdown } from \"../hooks\"\n\nexport interface CountdownProps extends Omit<TypographyProps, \"children\"> {\n  seconds: number\n  start?: boolean\n  onEnd: () => void\n}\n\nconst Countdown: FC<CountdownProps> = ({\n  seconds,\n  start = true,\n  onEnd,\n  ...typographyProps\n}) => {\n  seconds = Math.floor(seconds)\n  const _seconds = useCountdown(seconds)[0]\n  const [end, setEnd] = useState(!start)\n\n  if (_seconds === 0 && !end) {\n    setEnd(true)\n    onEnd()\n  }\n\n  seconds = Math.floor(_seconds % 60)\n  const minutes = Math.floor(_seconds / 60)\n\n  return (\n    <>\n      {_seconds > 0 && (\n        <Typography {...typographyProps}>\n          {minutes > 0 && `${minutes} ${minutes > 1 ? \"mins\" : \"min\"} `}\n          {seconds > 0 && `${seconds} ${seconds > 1 ? \"secs\" : \"sec\"}`}\n        </Typography>\n      )}\n    </>\n  )\n}\n\nexport default Countdown\n"],"names":["useExternalScript","props","attrs","eventTypes","eventType","setEventType","useState","useEffect","script","key","value","eventListener","event","useCountdown","seconds","interval","_seconds","_setSeconds","countdown","useEventListener","element","type","listener","kwArgs","options","deps","Countdown","start","onEnd","typographyProps","end","setEnd","minutes","jsxs","Typography"],"mappings":"kNAQO,SAASA,EAA+D,CAC7E,MAAAC,EACA,MAAAC,EACA,WAAAC,CACF,EAI0B,CACxB,KAAM,CAACC,EAAWC,CAAY,EAAIC,WAAA,EAElCC,OAAAA,EAAAA,UAAU,IAAM,CACd,GACE,SAAS,cAAiC,eAAeN,EAAM,GAAG,IAAI,EAEtE,MAAM,MAAM,gBAAgB,EAG9B,MAAMO,EAAS,SAAS,cAAc,QAAQ,EAE9C,OAAO,QAAQP,CAAK,EAAE,QAAQ,CAAC,CAACQ,EAAKC,CAAK,IAAM,CAE9CF,EAAOC,CAAG,EAAIC,CAChB,CAAC,EAEGR,IAAU,QACZ,OAAO,QAAQA,CAAK,EAAE,QAAQ,CAAC,CAACO,EAAKC,CAAK,IAAM,CAC9CF,EAAO,aAAaC,EAAKC,CAAK,CAChC,CAAC,EAGH,SAASC,EAAcC,EAAoB,CACzCP,EAAaO,EAAM,IAAiB,CACtC,CAEA,OAAAT,GAAY,QAAQC,GAAa,CAC/BI,EAAO,iBAAiBJ,EAAWO,CAAa,CAClD,CAAC,EAED,SAAS,KAAK,YAAYH,CAAM,EAEzB,IAAM,CACXL,GAAY,QAAQC,GAAa,CAC/BI,EAAO,oBAAoBJ,EAAWO,CAAa,CACrD,CAAC,EAED,SAAS,KAAK,YAAYH,CAAM,CAClC,CACF,EAAG,CAACL,EAAYD,EAAOD,CAAK,CAAC,EAEtBG,CACT,CAEO,SAASS,EACdC,EACAC,EAAmB,EACyB,CAC5C,GAAID,GAAW,EAAG,MAAM,MAAM,qBAAqB,EACnD,GAAIC,GAAY,EAAG,MAAM,MAAM,sBAAsB,EAErD,KAAM,CAACC,EAAUC,CAAW,EAAIX,EAAAA,SAASQ,CAAO,EAEhDP,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMW,EAAY,YAAY,IAAM,CAClCD,EAAYH,IACVA,EAAUA,EAAUC,EACbD,EAAU,EAAI,EAAIA,EAC1B,CACH,EAAGC,EAAW,GAAI,EAElB,MAAO,IAAM,CACX,cAAcG,CAAS,CACzB,CACF,EAAG,CAACH,CAAQ,CAAC,EAEN,CAACC,EAAUC,CAAW,CAC/B,CAEO,SAASE,EACdC,EACAC,EACAC,EACAC,EAGI,CAAA,EACE,CACN,KAAM,CAAE,QAAAC,EAAS,KAAAC,EAAO,CAAA,GAAOF,EAE/BhB,EAAAA,UACE,KACEa,EAAQ,iBAAiBC,EAAMC,EAAUE,CAAO,EAEzC,IAAM,CACXJ,EAAQ,oBAAoBC,EAAMC,EAAUE,CAAO,CACrD,GAIFC,CAAA,CAEJ,CClGA,MAAMC,EAAgC,CAAC,CACrC,QAAAZ,EACA,MAAAa,EAAQ,GACR,MAAAC,EACA,GAAGC,CACL,IAAM,CACJf,EAAU,KAAK,MAAMA,CAAO,EAC5B,MAAME,EAAWH,EAAaC,CAAO,EAAE,CAAC,EAClC,CAACgB,EAAKC,CAAM,EAAIzB,EAAAA,SAAS,CAACqB,CAAK,EAEjCX,IAAa,GAAK,CAACc,IACrBC,EAAO,EAAI,EACXH,EAAA,GAGFd,EAAU,KAAK,MAAME,EAAW,EAAE,EAClC,MAAMgB,EAAU,KAAK,MAAMhB,EAAW,EAAE,EAExC,6DAEK,SAAAA,EAAW,GACViB,EAAAA,kBAAAA,KAACC,EAAAA,WAAA,CAAY,GAAGL,EACb,SAAA,CAAAG,EAAU,GAAK,GAAGA,CAAO,IAAIA,EAAU,EAAI,OAAS,KAAK,IACzDlB,EAAU,GAAK,GAAGA,CAAO,IAAIA,EAAU,EAAI,OAAS,KAAK,EAAA,CAAA,CAC5D,CAAA,CAEJ,CAEJ"}